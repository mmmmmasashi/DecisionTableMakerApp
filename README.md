# DecisionTableMakerApp

`DecisionTableMakerApp` は、因子と水準を基にディシジョンテーブルを生成する WPF アプリケーションです。このアプリケーションは、計算式を入力し、ディシジョンテーブルを視覚的に確認・編集するためのツールを提供します。

## 特徴

- **因子水準表のインポート**: 因子とその水準をツリー形式で表示。
- **計算式の入力と解析**: 計算式を入力してディシジョンテーブルを生成。
- **リアルタイムプレビュー**: ディシジョンテーブルのプレビューをデータグリッドで表示。


## 使用方法

1. アプリケーションを起動します。
2. 左側の「因子水準表取込」ボタンをクリックして因子水準表をインポートします。
   - Excel上で因子水準表を作成し、その範囲をクリップボードにコピーした状態で「取込」ボタンを押します。
   - 作成例
    
	| 因子   | 水準       |
	|----------|----------|
	| OS       | Windows  |
	|          | Mac      |
	|          | Linux    |
	| Language | Japanese |
	|          | English  |
	| Version  | 1.0      |
	|          | 2.0      |

3. 中央のテキストボックスに計算式を入力します。
   - 例: `[OS] * [Language] * [Version]`
4. 生成されたディシジョンテーブルはデータグリッドで確認できます。
5. データグリッドの内容をコピーしてExcelなどに貼り付けることができます。

## 計算式の書き方

計算式は、因子とその水準を組み合わせてディシジョンテーブルを生成するためのルールを記述します。以下に計算式の基本的な書き方を説明します。


### 基本構文

- **因子の指定**: 因子は `[因子名]` の形式で記述します。
  - 例: `[OS]`, `[Language]`, `[Version]`
- **掛け算 (`*`)**: 因子間の全ての組み合わせを生成します。
  - 例: `[OS] * [Language]` は、`OS` と `Language` の全ての組み合わせを生成します。
- **足し算 (`+`)**: 因子間の一部の組み合わせを生成します。
  - 各水準の数は同数程度となるように調整されます
- **水準の定義**: 因子名の後に括弧で水準を指定します。
  - 例: `[OS(Windows, Mac)]` は、`OS` の水準を `Windows` と `Mac` に限定、もしくは新たに定義します。
      - 因子水準表に存在しない水準を指定することも可能です。


### 制約
- 演算子は `*` と `+` のみを使用します。
- 順序を制御するための括弧は使用できません。

### 例
- "[OS] * [Language] + [Version]"
- "[FactorA(LevelA1,LevelA2)] + [FactorB(LevelB1,LevelB2)] * [FactorC(LevelC1,LevelC2)]"

### 注意事項

- 因子名や水準名は、因子水準表に存在するものを使用してください。
- 計算式に誤りがある場合、エラーが発生する可能性があります。

このルールに従って計算式を記述することで、柔軟にディシジョンテーブルを生成できます。


## オプション
- 必要に応じて「空白は無視」オプションをチェックします。
- 「末尾に追加するテキスト」セクションでカスタム行を追加できます。

## 開発者向け情報

### 必要条件

- .NET 8 ランタイム
- Windows OS

### インストール

1. このリポジトリをクローンします:
2. ソリューションを Visual Studio で開きます。
3. 必要な NuGet パッケージを復元します。
4. アプリケーションをビルドして実行します。

### プロジェクト構成

- **DecisionTableLib**: ディシジョンテーブルのロジックを実装したライブラリ。
- **DecisionTableMakerApp**: WPF アプリケーションの UI 部分。
- **DecisionTableLibTest**: ユニットテストプロジェクト。

### 主なファイル

- `MainWindow.xaml`: アプリケーションのメインウィンドウ。
- `DecisionTableMaker.cs`: ディシジョンテーブル生成ロジック。
- `RPN.cs`: 逆ポーランド記法の解析ロジック。

## 貢献

バグ報告や機能リクエストは [Issues](https://github.com/your-repo/DecisionTableMakerApp/issues) で受け付けています。

## ライセンス

このプロジェクトは [MIT ライセンス](LICENSE) の下で公開されています。